# ูุธุงู ุฅุฏุงุฑุฉ ูุนูููุงุช ุงูุทูุงุจ - Student Management System

## ูุธุฑุฉ ุนุงูุฉ
ูุธุงู ูุชูุงูู ูุฅุฏุงุฑุฉ ูุนูููุงุช ุงูุทูุงุจ ูุชู ุชูุนููู ุชููุงุฆูุงู ุนูุฏ ุชุณุฌูู ุงูุฏุฎููุ ูุน ุงูุชูุงูู ุงููุงูู ูุน ูุธุงู ุงูุญูุงูุฉ ููููุฏูููุงุช.

## ุงูููุฒุงุช ุงูุฑุฆูุณูุฉ

### ๐ ุฌูุจ ูุนูููุงุช ุงูุทุงูุจ ุงูุชููุงุฆู
- **ุชูุนูู ุชููุงุฆู**: ูุชู ุฌูุจ ูุนูููุงุช ุงูุทุงูุจ ุชููุงุฆูุงู ุนูุฏ ุชุณุฌูู ุงูุฏุฎูู ุงููุงุฌุญ
- **ุงุณุชุฎุฏุงู Student ID**: ูุณุชุฎุฏู student_id ูู ุงุณุชุฌุงุจุฉ ุชุณุฌูู ุงูุฏุฎูู
- **API ุงูุชูุงูู**: ูุณุชุฏุนู `/api/students/{student_id}` ููุญุตูู ุนูู ุงููุนูููุงุช ุงููุงููุฉ
- **ุญูุธ ูุญูู**: ูุญูุธ ุงููุนูููุงุช ูุญููุงู ูุณุฑุนุฉ ุงููุตูู

### ๐ ุงูุชูุงูู ูุน ูุธุงู ุงูุญูุงูุฉ
- **ูููุฉ ุงูุทุงูุจ**: ูุนูููุงุช ุงูุทุงูุจ ุชุณุชุฎุฏู ูู ุงูุนูุงูุฉ ุงููุงุฆูุฉ
- **ุญูุงูุฉ ุงูููุฏูููุงุช**: ุฑุจุท ูู ููุฏูู ุจูููุฉ ุทุงูุจ ูุญุฏุฏุฉ
- **ุชุชุจุน ุงููุดุงูุฏุฉ**: ุฅููุงููุฉ ุชุชุจุน ูู ุดุงูุฏ ุฃู ููุฏูู

### ๐ฑ ูุงุฌูุงุช ุงููุณุชุฎุฏู
- **ุนุฑุถ ูุฏูุฌ**: widget ูุนุฑุถ ูุนูููุงุช ุงูุทุงูุจ ูู ุฃู ููุงู
- **ูุนูููุงุช ูุงููุฉ**: ุดุงุดุฉ ุชูุตูููุฉ ูุฌููุน ุจูุงูุงุช ุงูุทุงูุจ
- **AppBar Widget**: ุนุฑุถ ุณุฑูุน ูู ุดุฑูุท ุงูุชุทุจูู

## ุงููููุงุช ูุงูุฎุฏูุงุช

### `StudentService` - ุงูุฎุฏูุฉ ุงูุฑุฆูุณูุฉ
```dart
// ุฌูุจ ูุนูููุงุช ุงูุทุงูุจ
Map<String, dynamic>? studentInfo = await StudentService.getStudentInfo(studentId);

// ุงูุชุญูู ูู ูุฌูุฏ ูุนูููุงุช ูุญููุฉ
bool hasInfo = await StudentService.hasLocalStudentInfo();

// ุฌูุจ ุงููุนูููุงุช ุงููุญููุธุฉ ูุญููุงู
Map<String, String?> localInfo = await StudentService.getLocalStudentInfo();
```

### `UserInfoService` - ุฅุฏุงุฑุฉ ุงูุจูุงูุงุช ุงููุญููุฉ (ูุญุฏุซ)
```dart
// ุญูุธ ูุนุฑู ุงูุทุงูุจ
await UserInfoService.saveStudentId("student_id_here");

// ุงูุญุตูู ุนูู ูุนุฑู ุงูุทุงูุจ
String? studentId = await UserInfoService.getStudentId();

// ุญูุธ ุฌููุน ุงููุนูููุงุช
await UserInfoService.saveUserInfo(
  phone: "+964XXXXXXXXX",
  userName: "ุงุณู ุงูุทุงูุจ",
  studentId: "student_id_here",
);
```

### `StudentInfoWidget` - ูุงุฌูุฉ ุงูุนุฑุถ
```dart
// ุนุฑุถ ูุฏูุฌ ุจุณูุท
StudentInfoWidget()

// ุนุฑุถ ูุงูู ูุน ุฌููุน ุงูุชูุงุตูู
StudentInfoWidget(showFullInfo: true)

// widget ููู AppBar
StudentInfoAppBarWidget()
```

## ุงูุชูุงูู ูุน AuthController

### ุชุญุฏูุซ ุนูููุฉ ุชุณุฌูู ุงูุฏุฎูู
```dart
// ูู ุฏุงูุฉ login()
final response = await _repo.loginAndGetResponse(...);

// ุงุณุชุฏุนุงุก ูุนูููุงุช ุงูุทุงูุจ ุชููุงุฆูุงู
await StudentService.loadStudentInfoFromLogin(response);
```

### ุชูุธูู ุงูุจูุงูุงุช ุนูุฏ ุชุณุฌูู ุงูุฎุฑูุฌ
```dart
// ูู ุฏุงูุฉ logout()
await StudentService.clearLocalStudentInfo();
```

## ุงุณุชุฌุงุจุฉ API ุงููุชููุนุฉ

### ูู ุชุณุฌูู ุงูุฏุฎูู `/api/auth/login`
```json
{
  "token": "eyJ0eXAiOiJKV1QiLCJhbGciOiJSUzI1NiJ9...",
  "user": {
    "id": "55de4c2d-7685-422f-a91d-787d2ac8109",
    "name": "ูุญูุฏ ุนูู ุงูุฎุฑูุฌู",
    "email": "student4@tech.edu.sa",
    "institute_id": "1cc39749-b6e8-4b43-b813-7668fd172418"
  },
  "student_id": "29465db3-6d1f-4158-8db5-177276b9e722"
}
```

### ูู ูุนูููุงุช ุงูุทุงูุจ `/api/students/{student_id}`
```json
{
  "id": "29465db3-6d1f-4158-8db5-177276b9e722",
  "name": "ูุญูุฏ ุนูู ุงูุฎุฑูุฌู",
  "email": "student4@tech.edu.sa",
  "phone": "+966517539654",
  "institute_id": "1cc39749-b6e8-4b43-b813-7668fd172418",
  "status": "active",
  "last_latitude": 33.3743428,
  "last_longitude": 44.4883112,
  "last_accuracy": 20,
  "last_location_source": "gps",
  "last_device_info": "PostmanRuntime/7.42.0",
  "last_user_agent": "PostmanRuntime/7.42.0",
  "last_ip_address": "192.168.0.167",
  "last_seen_at": "2025-08-19 13:59:44",
  "created_at": "2025-08-19T13:30:16.000000Z"
}
```

## ุขููุฉ ุงูุนูู

### 1. ุนูุฏ ุชุณุฌูู ุงูุฏุฎูู
```dart
1. ุงููุณุชุฎุฏู ูุฏุฎู email ู password
2. ูุชู ุฅุฑุณุงู ุงูุทูุจ ุฅูู /api/auth/login
3. ุงูุงุณุชุฌุงุจุฉ ุชุญุชูู ุนูู student_id
4. ูุชู ุงุณุชุฏุนุงุก StudentService.loadStudentInfoFromLogin()
5. ูุชู ุฌูุจ ุงููุนูููุงุช ูู /api/students/{student_id}
6. ูุชู ุญูุธ ุงููุนูููุงุช ูุญููุงู ูู SharedPreferences
```

### 2. ูู ูุธุงู ุงูุญูุงูุฉ
```dart
// ูู ProtectedYouTubePlayer
String protectionId = await UserInfoService.getProtectionId();
// ูุนุทู: ุฑูู ุงููุงุชู ุฃู "ุทุงูุจ-{student_id}" ุฃู ุงุณู ุงููุณุชุฎุฏู
```

### 3. ุนุฑุถ ุงููุนูููุงุช
```dart
// ูู ุฃู ุดุงุดุฉ
StudentInfoWidget() // ุนุฑุถ ุจุณูุท
StudentInfoWidget(showFullInfo: true) // ุนุฑุถ ูุงูู
```

## ุงูููุงุฆุฏ

### ูููุทูุฑูู
- **ุชูุงูู ุชููุงุฆู**: ูุง ุญุงุฌุฉ ูุงุณุชุฏุนุงุกุงุช ูุฏููุฉ
- **ุจูุงูุงุช ูุญููุฉ**: ุณุฑุนุฉ ูู ุงููุตูู ูููุนูููุงุช
- **ูุฑููุฉ**: ูููู ุงุณุชุฎุฏุงู ุงููุนูููุงุช ูู ุฃู ุฌุฒุก ูู ุงูุชุทุจูู

### ูููุณุชุฎุฏููู
- **ุชุฌุฑุจุฉ ุณูุณุฉ**: ุงููุนูููุงุช ุชูุฌูุจ ุชููุงุฆูุงู
- **ุญูุงูุฉ ูุฎุตุตุฉ**: ุงูุนูุงูุฉ ุงููุงุฆูุฉ ุชุญุชูู ุนูู ูุนูููุงุช ุญููููุฉ
- **ุฎุตูุตูุฉ**: ุงูุจูุงูุงุช ูุญููุธุฉ ูุญููุงู ููุท

### ููุฅุฏุงุฑุฉ
- **ุชุชุจุน ุฏููู**: ูุนุฑูุฉ ูููุฉ ูู ูุดุงูุฏ ููููุฏูููุงุช
- **ุฃูุงู ุนุงูู**: ุฑุจุท ุงููุญุชูู ุจูููุงุช ุญููููุฉ
- **ุจูุงูุงุช ุดุงููุฉ**: ูุนูููุงุช ูุงููุฉ ุนู ูู ุทุงูุจ

## ุฃูุซูุฉ ุงูุงุณุชุฎุฏุงู

### ูู ุงูุดุงุดุฉ ุงูุฑุฆูุณูุฉ
```dart
class HomeScreen extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    return Scaffold(
      appBar: AppBar(
        title: Text('ุงูุตูุญุฉ ุงูุฑุฆูุณูุฉ'),
        actions: [
          StudentInfoAppBarWidget(), // ุนุฑุถ ูุนูููุงุช ุงูุทุงูุจ
        ],
      ),
      body: Column(
        children: [
          StudentInfoWidget(), // ุนุฑุถ ูุฏูุฌ ูููุนูููุงุช
          // ุจุงูู ูุญุชูู ุงูุดุงุดุฉ
        ],
      ),
    );
  }
}
```

### ูู ุฅุนุฏุงุฏุงุช ุงูููู ุงูุดุฎุตู
```dart
class ProfileScreen extends StatelessWidget {
  @override
  Widget build(BuildContext context) {
    return Scaffold(
      body: Column(
        children: [
          StudentInfoWidget(showFullInfo: true), // ุนุฑุถ ูุงูู
          // ุฅุนุฏุงุฏุงุช ุฃุฎุฑู
        ],
      ),
    );
  }
}
```

### ุชุญุฏูุซ ูุนูููุงุช ุงูุทุงูุจ
```dart
// ุชุญุฏูุซ ุฑูู ุงููุงุชู
bool success = await StudentService.updateStudentInfo(
  studentId,
  {'phone': '+964XXXXXXXXX'}
);
```

## ูุตุงุฆุญ ุงูุชุทููุฑ

### 1. ุงูุชุญูู ูู ูุฌูุฏ ุงููุนูููุงุช
```dart
if (await StudentService.hasLocalStudentInfo()) {
  // ุงููุนูููุงุช ููุฌูุฏุฉ
} else {
  // ุนุฑุถ ุฑุณุงูุฉ ุฃู ุฅุนุงุฏุฉ ุชูุฌูู ูุชุณุฌูู ุงูุฏุฎูู
}
```

### 2. ุงูุชุนุงูู ูุน ุงูุฃุฎุทุงุก
```dart
try {
  final info = await StudentService.getStudentInfo(studentId);
  if (info == null) {
    // ูุดู ูู ุฌูุจ ุงููุนูููุงุช
  }
} catch (e) {
  // ูุนุงูุฌุฉ ุงูุฎุทุฃ
}
```

### 3. ุชุญุฏูุซ ูุงุฌูุฉ ุงููุณุชุฎุฏู
```dart
// ุงุณุชุฎุฏู FutureBuilder ููุชุญุฏูุซ ุงูุชููุงุฆู
FutureBuilder<Map<String, String?>>(
  future: StudentService.getLocalStudentInfo(),
  builder: (context, snapshot) {
    // ุจูุงุก ุงููุงุฌูุฉ ุญุณุจ ุงูุจูุงูุงุช
  },
)
```

---

ูุฐุง ุงููุธุงู ูููุฑ ุชูุงููุงู ูุงููุงู ุจูู ูุนูููุงุช ุงูุทูุงุจ ููุธุงู ุงูุญูุงูุฉุ ููุง ูุถูู ุชุฌุฑุจุฉ ูุณุชุฎุฏู ููุชุงุฒุฉ ูุน ุฃูุงู ุนุงูู. ๐๐โจ
