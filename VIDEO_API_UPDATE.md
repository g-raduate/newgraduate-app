# تحديث API endpoint للفيديوهات

## التغيير المُنفذ

### من:
```
GET /api/courses/{courseId}/videos
```

### إلى:
```
GET /api/courses/{course}/videos/previews
```

## الوظيفة الجديدة

### 1. **API Endpoint الجديد**
- يعرض عناوين جميع الفيديوهات في الدورة
- يعيد روابط الفيديوهات المجانية فقط
- الفيديوهات المدفوعة تظهر بدون روابط

### 2. **بنية الاستجابة المتوقعة**
```json
{
  "data": [
    {
      "id": "1",
      "title": "مقدمة الدورة", 
      "link": "https://example.com/videos/.../lesson-1",
      "order": 1,
      "is_free": true,
      "created_at": "2025-01-01T10:00:00.000000Z"
    },
    {
      "id": "2",
      "title": "الأساسيات ( AND , NOT && NAND )",
      "link": null,
      "order": 2, 
      "is_free": false,
      "created_at": "2025-01-02T10:00:00.000000Z"
    }
  ]
}
```

### 3. **معالجة التفاعل مع الفيديوهات**

#### الفيديوهات المجانية مع رابط:
- ✅ إظهار أيقونة القفل المفتوح الأخضر
- ✅ رسالة "مجاني" باللون الأخضر  
- ✅ عند الضغط: رسالة نجاح خضراء وإمكانية التشغيل

#### الفيديوهات المدفوعة:
- 🔒 إظهار أيقونة القفل المغلق البرتقالي
- 🔒 رسالة "مدفوع" باللون البرتقالي
- 🔒 عند الضغط: رسالة تحذير "يتطلب اشتراك"

#### الفيديوهات المجانية بدون رابط:
- ⚠️ عند الضغط: رسالة خطأ "الفيديو غير متوفر حالياً"

## الملفات المُحدثة

### `course_detail_screen.dart`
1. **تحديث URL**:
```dart
final url = '${AppConstants.baseUrl}/api/courses/$courseId/videos/previews';
```

2. **تحديث البيانات الوهمية**:
```dart
{
  'id': '2',
  'title': 'الأساسيات ( AND , NOT && NAND )',
  'link': null, // الفيديو المدفوع لا يحتوي على رابط
  'order': 2,
  'is_free': false,
}
```

3. **تحسين منطق التفاعل**:
```dart
final hasLink = video['link'] != null && 
               video['link'].toString().isNotEmpty;

if (isFree && hasLink) {
  // تشغيل الفيديو المجاني
} else if (!isFree) {
  // فيديو مدفوع - يتطلب اشتراك
} else {
  // فيديو مجاني لكن بدون رابط
}
```

## المميزات الجديدة

### 1. **تجربة مستخدم محسنة**
- رسائل واضحة ومختلفة للحالات المختلفة
- ألوان مميزة لكل نوع فيديو
- تحذيرات مناسبة للمحتوى المدفوع

### 2. **أمان المحتوى**
- الفيديوهات المدفوعة لا تعرض روابطها
- التحكم في الوصول من جانب الخادم
- معاينة فقط للمحتوى المجاني

### 3. **مرونة التطبيق**
- معالجة الحالات المختلفة للروابط
- دعم الفيديوهات المجانية والمدفوعة
- تحضير لإضافة نظام الاشتراكات

## التطوير المستقبلي

### الخطوات التالية:
1. **إضافة مشغل فيديو**: استخدام `url_launcher` أو `video_player`
2. **نظام الاشتراكات**: API للتحقق من اشتراك المستخدم
3. **تحميل الفيديوهات**: للمشاهدة دون اتصال
4. **تتبع التقدم**: حفظ موضع المشاهدة
