# ุญู ูุดููุฉ ุชุญุฏูุซ ุงููุงุด ุนูุฏ ุฅุถุงูุฉ ูุญุงุถุฑุงุช ุฌุฏูุฏุฉ

## ุงููุดููุฉ
ุนูุฏ ุฅุถุงูุฉ ูุญุงุถุฑุฉ ุฌุฏูุฏุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุชุ ูู ุชูู ุชุธูุฑ ูู ุงูุชุทุจูู ููุฑุงู ุจุณุจุจ ูุธุงู ุงููุงุด. ูุงู ุงููุณุชุฎุฏู ูุญุชุงุฌ ูุฅุนุงุฏุฉ ุชุดุบูู ุงูุชุทุจูู ุฃู ุชุณุฌูู ุงูุฎุฑูุฌ ูุงูุฏุฎูู ูุฑุคูุฉ ุงููุญุงุถุฑุฉ ุงูุฌุฏูุฏุฉ.

## ุงูุญู ุงููุทุจู

### 1. ุชุญุณูู ุฅุนุฏุงุฏุงุช ุงููุงุด
**ุงูููู:** `lib/services/cache_manager.dart`

```dart
// ุชูููู ูุฏุฉ ุงูุชูุงุก ุตูุงุญูุฉ ุงููุงุด ููููุฏูููุงุช ูู 30 ุฏูููุฉ ุฅูู 15 ุฏูููุฉ
static const int _shortCacheExpirySeconds = 900; // 15 ุฏูููุฉ (ุชู ุชูููููุง ูู 30 ุฏูููุฉ)
```

**ุงูููุงุฆุฏ:**
- ุงูุจูุงูุงุช ุณุชูุญุฏูุซ ุชููุงุฆูุงู ูู 15 ุฏูููุฉ ุจุฏูุงู ูู 30 ุฏูููุฉ
- ุชูููู ุงูููุช ุงููุงุฒู ูุธููุฑ ุงููุญุงุถุฑุงุช ุงูุฌุฏูุฏุฉ

### 2. ุฅุถุงูุฉ ุฏูุงู ูุณุญ ุงููุงุด
**ุงูููู:** `lib/services/cache_manager.dart`

```dart
// ุฏุงูุฉ ูุณุญ ูุงุด ุงูููุฏูููุงุช ูุฏูุฑุฉ ูุนููุฉ
Future<bool> clearVideosCache(String courseId) async {
  return await removeCache('course_$courseId', type: CacheType.videos);
}

// ุฏุงูุฉ ูุณุญ ูุงุด ุงูููุฎุตุงุช ูุฏูุฑุฉ ูุนููุฉ  
Future<bool> clearSummariesCache(String courseId) async {
  return await removeCache('course_$courseId', type: CacheType.summaries);
}
```

**ุงูููุงุฆุฏ:**
- ุฅููุงููุฉ ูุณุญ ุงููุงุด ุจุฏูุฉ ูุฏูุฑุฉ ูุญุฏุฏุฉ
- ุนุฏู ุงูุญุงุฌุฉ ููุณุญ ูุงูู ุงููุงุด

### 3. ุฅุถุงูุฉ ุฒุฑ ุชุญุฏูุซ ูู ูุงุฌูุฉ ุชูุงุตูู ุงูุฏูุฑุฉ
**ุงูููู:** `lib/features/courses/screens/course_detail_screen.dart`

```dart
actions: [
  // ุฒุฑ ุงูุชุญุฏูุซ
  IconButton(
    icon: Icon(
      Icons.refresh,
      color: Theme.of(context).colorScheme.onSurface,
    ),
    onPressed: _refreshCourseData,
    tooltip: 'ุชุญุฏูุซ ุงูุจูุงูุงุช',
  ),
],
```

**ุงูููุงุฆุฏ:**
- ุชุญุฏูุซ ููุฑู ููุจูุงูุงุช ุนูุฏ ุงูุถุบุท ุนูู ุงูุฒุฑ
- ูุงุฌูุฉ ุณููุฉ ููุฃูููุฉ ูููุณุชุฎุฏู

### 4. ุฅุถุงูุฉ ุฏุงูุฉ ุงูุชุญุฏูุซ ุงูุฅุฌุจุงุฑู
**ุงูููู:** `lib/features/courses/screens/course_detail_screen.dart`

```dart
/// ุชุญุฏูุซ ุจูุงูุงุช ุงูุฏูุฑุฉ (ูุณุญ ุงููุงุด ูุฅุนุงุฏุฉ ุงูุชุญููู)
Future<void> _refreshCourseData() async {
  try {
    final courseId = widget.course['course_id']?.toString() ?? 
                     widget.course['id']?.toString();
    
    if (courseId != null) {
      print('๐ ุจุฏุก ุชุญุฏูุซ ุจูุงูุงุช ุงูุฏูุฑุฉ $courseId');
      
      // ูุณุญ ุงููุงุด ุงููุฏูู
      await CacheManager.instance.clearVideosCache(courseId);
      await CacheManager.instance.clearSummariesCache(courseId);
      print('๐๏ธ ุชู ูุณุญ ุงููุงุด ููุฏูุฑุฉ $courseId');
      
      // ุฅุนุงุฏุฉ ุชุญููู ุงูุจูุงูุงุช
      await _loadCourseData();
      
      // ุฅุธูุงุฑ ุฑุณุงูุฉ ูุฌุงุญ
      if (mounted) {
        ScaffoldMessenger.of(context).showSnackBar(
          SnackBar(
            content: Row(
              children: [
                Icon(Icons.check_circle, color: Theme.of(context).colorScheme.onPrimary),
                const SizedBox(width: 8),
                const Expanded(child: Text('ุชู ุชุญุฏูุซ ุงูุจูุงูุงุช ุจูุฌุงุญ')),
              ],
            ),
            backgroundColor: Colors.green,
            duration: const Duration(seconds: 2),
          ),
        );
      }
    }
  } catch (e) {
    // ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก...
  }
}
```

**ุงูููุงุฆุฏ:**
- ูุณุญ ุงููุงุด ุงููุฏูู ูุจู ุงูุชุญููู
- ุฅุนุงุฏุฉ ุชุญููู ุงูุจูุงูุงุช ูู ุงูุณูุฑูุฑ
- ุฑุณุงุฆู ุชุฃููุฏ ูููุณุชุฎุฏู

### 5. ุฅุถุงูุฉ Pull-to-Refresh
**ุงูููู:** `lib/features/courses/screens/course_detail_screen.dart`

```dart
// ูุญุชูู ุงูุฏูุฑุฉ
Expanded(
  child: widget.course['is_free_course'] == true
      ? RefreshIndicator(
          onRefresh: _refreshCourseData,
          child: _buildVideosTab(),
        )
      : TabBarView(
          controller: _tabController,
          children: [
            // ุชุจููุจุฉ ุงูููุฏูููุงุช
            RefreshIndicator(
              onRefresh: _refreshCourseData,
              child: _buildVideosTab(),
            ),
            // ุชุจููุจุฉ ุงูููุฎุตุงุช  
            RefreshIndicator(
              onRefresh: _refreshCourseData,
              child: _buildSummariesTab(),
            ),
          ],
        ),
),
```

**ุงูููุงุฆุฏ:**
- ุงูุณุญุจ ูุฃุณูู ูุชุญุฏูุซ ุงูุจูุงูุงุช (ุชุฌุฑุจุฉ ูุณุชุฎุฏู ูุฃูููุฉ)
- ูุนูู ูู ุฌููุน ุงูุชุจููุจุงุช
- ุชูุงุนู ุจุฏููู ูุณูู

### 6. ุชุญุฏูุซ ุฏูุงู ุงูุชุญููู ูุฏุนู ุงูุชุญุฏูุซ ุงูุฅุฌุจุงุฑู
**ุงูููู:** `lib/features/courses/screens/course_detail_screen.dart`

```dart
Future<void> _loadCourseData() async {
  await Future.wait([
    _loadVideos(forceRefresh: true),
    _loadSummaries(forceRefresh: true),
  ]);
}

Future<void> _loadSummaries({bool forceRefresh = false}) async {
  // ูุญุงููุฉ ุชุญููู ุงูุจูุงูุงุช ูู ุงููุงุด ุฃููุงู (ุฅูุง ุฅุฐุง ูุงู ุงูุชุญุฏูุซ ุฅุฌุจุงุฑู)
  if (!forceRefresh) {
    // ุชุญููู ูู ุงููุงุด...
  } else {
    print('๐ ุชุญุฏูุซ ุฅุฌุจุงุฑู ููููุฎุตุงุช - ุชุฌุงูู ุงููุงุด');
  }
  // ุจุงูู ููุทู ุงูุชุญููู...
}
```

**ุงูููุงุฆุฏ:**
- ูุฑููุฉ ูู ุชุญุฏูุฏ ูุชู ูุชู ุชุฌุงูู ุงููุงุด
- ุฏุนู ุงูุชุญุฏูุซ ุงูุฅุฌุจุงุฑู ุนูุฏ ุงูุญุงุฌุฉ

### 7. ุชุญุณูู ูุงุฌูุฉ ุญุงูุงุช ุงูุชุญููู ูุงูุฃุฎุทุงุก
**ุงูููู:** `lib/features/courses/screens/course_detail_screen.dart`

```dart
// ุชุญููู Center ุฅูู ListView ูุฏุนู RefreshIndicator
if (isLoadingVideos) {
  return ListView(
    children: [
      SizedBox(height: MediaQuery.of(context).size.height * 0.3),
      const Center(
        child: Column(
          mainAxisAlignment: MainAxisAlignment.center,
          children: [
            CircularProgressIndicator(),
            SizedBox(height: 16),
            Text('ุฌุงุฑู ุชุญููู ุงูููุฏูููุงุช...'),
          ],
        ),
      ),
    ],
  );
}
```

**ุงูููุงุฆุฏ:**
- ุชุชูุงูู ูุน RefreshIndicator
- ุชุฌุฑุจุฉ ูุณุชุฎุฏู ูุชุณูุฉ

## ุงููุชูุฌุฉ

### โ ูุง ุชู ุญูู:
1. **ุงูุชุญุฏูุซ ุงูููุฑู**: ุงููุญุงุถุฑุงุช ุงูุฌุฏูุฏุฉ ุชุธูุฑ ููุฑุงู ุนูุฏ ุงุณุชุฎุฏุงู ุฒุฑ ุงูุชุญุฏูุซ ุฃู Pull-to-Refresh
2. **ุงูุชุญุฏูุซ ุงูุชููุงุฆู**: ุงูุจูุงูุงุช ุชูุญุฏูุซ ุชููุงุฆูุงู ูู 15 ุฏูููุฉ ุจุฏูุงู ูู 30 ุฏูููุฉ
3. **ุชุฌุฑุจุฉ ุงููุณุชุฎุฏู**: ุทุฑู ูุชุนุฏุฏุฉ ูุณููุฉ ููุชุญุฏูุซ (ุฒุฑ + ุณุญุจ)
4. **ุงุณุชูุฑุงุฑ ุงููุธุงู**: ุนุฏู ุงูุญุงุฌุฉ ูุฅุนุงุฏุฉ ุชุดุบูู ุงูุชุทุจูู ุฃู ุชุณุฌูู ุงูุฎุฑูุฌ

### ๐ฑ ุทุฑู ุงูุชุญุฏูุซ ุงููุชุงุญุฉ:
1. **ุงูุฒุฑ**: ุงูุถุบุท ุนูู ุฃููููุฉ ุงูุชุญุฏูุซ ูู ุดุฑูุท ุงูุชุทุจูู
2. **Pull-to-Refresh**: ุงูุณุญุจ ูุฃุณูู ูู ูุงุฆูุฉ ุงููุญุงุถุฑุงุช
3. **ุงูุชููุงุฆู**: ุงูุชุญุฏูุซ ูู 15 ุฏูููุฉ ุชููุงุฆูุงู
4. **ุฅุนุงุฏุฉ ุงููุญุงููุฉ**: ุฒุฑ ูู ุญุงูุฉ ูุดู ุงูุชุญููู

### ๐ง ุงูุชุญุณููุงุช ุงูุชูููุฉ:
- ุชูููู ูุฏุฉ ุงูุชูุงุก ุตูุงุญูุฉ ุงููุงุด
- ุฏูุงู ูุชุฎุตุตุฉ ููุณุญ ุงููุงุด  
- ุฏุนู ุงูุชุญุฏูุซ ุงูุฅุฌุจุงุฑู
- ูุนุงูุฌุฉ ุฃูุถู ููุฃุฎุทุงุก
- ูุงุฌูุฉ ูุชุฌุงูุจุฉ ูุน ุฌููุน ุงูุญุงูุงุช

## ุงูุงุณุชุฎุฏุงู

ุนูุฏ ุฅุถุงูุฉ ูุญุงุถุฑุฉ ุฌุฏูุฏุฉ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุชุ ูููู ูููุณุชุฎุฏู:

1. **ุงูุถุบุท ุนูู ุฒุฑ ุงูุชุญุฏูุซ** (ุฃููููุฉ ุงูุชุญุฏูุซ ูู ุงูุฃุนูู)
2. **ุงูุณุญุจ ูุฃุณูู** ูู ูุงุฆูุฉ ุงููุญุงุถุฑุงุช  
3. **ุงูุงูุชุธุงุฑ 15 ุฏูููุฉ** ููุชุญุฏูุซ ุงูุชููุงุฆู

ูุณุชุธูุฑ ุงููุญุงุถุฑุฉ ุงูุฌุฏูุฏุฉ ููุฑุงู ุฏูู ุงูุญุงุฌุฉ ูุฅุนุงุฏุฉ ุชุดุบูู ุงูุชุทุจูู.
